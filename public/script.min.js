(function(){"use strict";const detectDevice=()=>{const userAgent=navigator.userAgent;const isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(userAgent);const isTablet=/(iPad|Tablet|PlayBook|Silk)|(Android(?!.*Mobile))/i.test(userAgent);const isDesktop=!isMobile&&!isTablet;const isIOS=/iPad|iPhone|iPod/.test(userAgent);const isAndroid=/Android/i.test(userAgent);return{isMobile:isMobile,isTablet:isTablet,isDesktop:isDesktop,isIOS:isIOS,isAndroid:isAndroid,isTouchDevice:"ontouchstart"in window||navigator.maxTouchPoints>0}};const getEnvironment=()=>{const hostname=window.location.hostname;if(hostname==="localhost"||hostname==="127.0.0.1"||hostname.includes("local")){return"development"}else if(hostname.includes("staging")||hostname.includes("test")){return"staging"}return"production"};const device=detectDevice();const environment=getEnvironment();const CONFIG={device:device,environment:environment,slideInterval:device.isMobile?6e3:5e3,exitIntentDelay:device.isMobile?3e4:45e3,urgencyBarDelay:device.isMobile?2e4:3e4,socialProofInterval:device.isMobile?15e3:12e3,socialProofDelay:device.isMobile?1e4:8e3,countdownDuration:15*60*1e3,contact:{whatsappNumber:"6282148489595",email:"cardosebox@gmail.com",phone:"+62-821-4848-9595",address:{street:"Raya Grogol 110",city:"Sukoharjo",country:"Indonesia",coordinates:{lat:-7.6783,lng:110.8403}},businessHours:{weekday:{open:"08:00",close:"17:00"},saturday:{open:"08:00",close:"17:00"},sunday:{open:"appointment",close:"only"}}},version:"2.0.0",features:{enableExitIntent:device.isDesktop,enableSocialProof:true,enableUrgencyBar:true,enableAnalytics:environment==="production",enableServiceWorker:"serviceWorker"in navigator,enablePushNotifications:"Notification"in window,enableGeolocation:"geolocation"in navigator},animations:{defaultDuration:device.isMobile?600:800,defaultEasing:"ease-out-cubic",offset:device.isMobile?50:100,once:true,disableOnLowPerformance:true},breakpoints:{xs:320,sm:576,md:768,lg:1024,xl:1280,xxl:1536},touch:{swipeThreshold:50,longPressDelay:500,tapTolerance:10,enableHoverOnTouch:device.isTouchDevice},performance:{lazyLoadOffset:device.isMobile?200:300,imageQuality:device.isMobile?"medium":"high",enableImageOptimization:true,deferNonCriticalJS:device.isMobile,preloadCriticalResources:!device.isMobile}};class Slideshow{constructor(){this.currentSlide=1;this.slideTimer=null;this.slides=null;this.dots=null;this.isInitialized=false}init(){this.slides=document.querySelectorAll(".slide");this.dots=document.querySelectorAll(".dot");if(!this.slides.length)return false;this.slides[0]?.classList.add("active");this.dots[0]?.classList.add("active");this.bindEvents();this.start();this.isInitialized=true;return true}bindEvents(){this.dots.forEach((dot,index)=>{dot.addEventListener("click",()=>{this.showSlide(index+1);this.reset()})});const sliderContainer=document.querySelector(".hero-slider");if(sliderContainer){sliderContainer.addEventListener("mouseenter",()=>this.pause());sliderContainer.addEventListener("mouseleave",()=>this.start())}document.addEventListener("keydown",e=>{if(e.key==="ArrowLeft"){this.showSlide(this.currentSlide-1);this.reset()}else if(e.key==="ArrowRight"){this.showSlide(this.currentSlide+1);this.reset()}})}showSlide(n){if(!this.slides.length)return;if(n>this.slides.length)this.currentSlide=1;else if(n<1)this.currentSlide=this.slides.length;else this.currentSlide=n;this.slides.forEach((slide,index)=>{slide.classList.toggle("active",index===this.currentSlide-1)});this.dots.forEach((dot,index)=>{dot.classList.toggle("active",index===this.currentSlide-1)});this.trackSlideView(this.currentSlide)}start(){if(this.slides.length<=1)return;this.slideTimer=setInterval(()=>{this.showSlide(this.currentSlide+1)},CONFIG.slideInterval)}pause(){if(this.slideTimer){clearInterval(this.slideTimer);this.slideTimer=null}}reset(){this.pause();this.start()}destroy(){this.pause();this.isInitialized=false}trackSlideView(slideNumber){if(window.analytics&&typeof window.analytics.track==="function"){window.analytics.track("slide_viewed",{slideNumber:slideNumber,slideTotal:this.slides.length})}}next(){this.showSlide(this.currentSlide+1);this.reset()}previous(){this.showSlide(this.currentSlide-1);this.reset()}goToSlide(slideNumber){this.showSlide(slideNumber);this.reset()}getCurrentSlide(){return this.currentSlide}getTotalSlides(){return this.slides.length}}class Navigation{constructor(){this.hamburger=null;this.navMenu=null;this.header=null;this.isMenuOpen=false;this.scrollThreshold=100}init(){this.hamburger=document.querySelector(".hamburger");this.navMenu=document.querySelector(".nav-menu");this.header=document.querySelector(".header");if(!this.hamburger||!this.navMenu)return false;this.bindEvents();this.initSmoothScrolling();this.initHeaderScrollEffects();this.initActiveLinks();return true}bindEvents(){this.hamburger.addEventListener("click",()=>{this.toggleMobileMenu()});document.addEventListener("click",e=>{if(this.isMenuOpen&&!this.navMenu.contains(e.target)&&!this.hamburger.contains(e.target)){this.closeMobileMenu()}});document.addEventListener("keydown",e=>{if(e.key==="Escape"&&this.isMenuOpen){this.closeMobileMenu()}});this.navMenu.querySelectorAll("a").forEach(link=>{link.addEventListener("click",()=>{this.closeMobileMenu()})});this.navMenu.addEventListener("click",e=>{e.stopPropagation()})}toggleMobileMenu(){this.isMenuOpen=!this.isMenuOpen;this.navMenu.classList.toggle("active",this.isMenuOpen);this.hamburger.setAttribute("aria-expanded",this.isMenuOpen);this.hamburger.classList.toggle("active",this.isMenuOpen);document.body.style.overflow=this.isMenuOpen?"hidden":"";this.animateHamburgerIcon(this.isMenuOpen)}closeMobileMenu(){this.isMenuOpen=false;this.navMenu.classList.remove("active");this.hamburger.setAttribute("aria-expanded","false");this.hamburger.classList.remove("active");document.body.style.overflow="";this.animateHamburgerIcon(false)}animateHamburgerIcon(isActive){const spans=this.hamburger.querySelectorAll("span");if(spans.length>=3){spans[0].style.transform=isActive?"rotate(45deg) translateY(6px)":"none";spans[1].style.opacity=isActive?"0":"1";spans[2].style.transform=isActive?"rotate(-45deg) translateY(-6px)":"none"}}initSmoothScrolling(){document.querySelectorAll('a[href^="#"]').forEach(anchor=>{anchor.addEventListener("click",e=>{const href=anchor.getAttribute("href");if(href==="#")return;e.preventDefault();const target=document.querySelector(href);if(target){const headerHeight=this.header?this.header.offsetHeight:80;const offsetTop=target.offsetTop-headerHeight;window.scrollTo({top:offsetTop,behavior:"smooth"});this.updateActiveLink(href)}})})}initHeaderScrollEffects(){if(!this.header)return;let lastScrollY=0;let ticking=false;const updateHeader=()=>{const scrollY=window.pageYOffset;this.header.classList.toggle("scrolled",scrollY>this.scrollThreshold);const urgencyBar=document.getElementById("urgencyBar");if(scrollY>lastScrollY&&scrollY>200){this.header.style.transform="translateY(-100%)";if(urgencyBar&&urgencyBar.classList.contains("show")){urgencyBar.style.top="0"}}else{this.header.style.transform="translateY(0)";if(urgencyBar&&urgencyBar.classList.contains("show")){urgencyBar.style.top=window.innerWidth<=768?"70px":"80px"}}lastScrollY=scrollY;ticking=false};window.addEventListener("scroll",()=>{if(!ticking){requestAnimationFrame(updateHeader);ticking=true}})}initActiveLinks(){const sections=document.querySelectorAll("section[id]");const navLinks=this.navMenu.querySelectorAll('a[href^="#"]');if(!sections.length)return;const updateActiveLink=()=>{const scrollY=window.pageYOffset;const headerHeight=this.header?this.header.offsetHeight:80;sections.forEach(section=>{const sectionTop=section.offsetTop-headerHeight-50;const sectionBottom=sectionTop+section.offsetHeight;const sectionId=`#${section.getAttribute("id")}`;if(scrollY>=sectionTop&&scrollY<sectionBottom){navLinks.forEach(link=>{link.classList.toggle("active",link.getAttribute("href")===sectionId)})}})};let ticking=false;window.addEventListener("scroll",()=>{if(!ticking){requestAnimationFrame(updateActiveLink);ticking=true}})}updateActiveLink(href){const navLinks=this.navMenu.querySelectorAll('a[href^="#"]');navLinks.forEach(link=>{link.classList.toggle("active",link.getAttribute("href")===href)})}openMenu(){if(!this.isMenuOpen){this.toggleMobileMenu()}}closeMenu(){if(this.isMenuOpen){this.closeMobileMenu()}}isMenuVisible(){return this.isMenuOpen}destroy(){this.closeMobileMenu();document.body.style.overflow=""}}class SecurityUtils{static sanitizeText(input){if(typeof input!=="string"){return""}return input.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;").trim()}static isValidEmail(email){const emailRegex=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return emailRegex.test(email)}static isValidPhone(phone){const phoneRegex=/^(\+62|62|0)[0-9]{8,12}$/;return phoneRegex.test(phone.replace(/[\s-]/g,""))}static isValidWhatsAppNumber(number){const waRegex=/^[1-9][0-9]{7,14}$/;return waRegex.test(number)}static sanitizeFormData(formData){const sanitized={};for(const[key,value]of Object.entries(formData)){if(typeof value==="string"){sanitized[key]=this.sanitizeText(value)}else{sanitized[key]=value}}return sanitized}static createSafeWhatsAppMessage(data){const safeName=data.name||"Not provided";const safeEmail=data.email||"Not provided";const safePhone=data.phone||"Not provided";const safeBoxType=data.boxType||"Not specified";const safeMessage=data.message||"No additional details";return`Hi! I'm interested in your Premium Gift Box services.\n\nName: ${safeName}\nEmail: ${safeEmail}\nPhone: ${safePhone}\nProject Type: ${safeBoxType}\nDetails: ${safeMessage}\n\nThank you for your time!`}static validateContactForm(formData){const data=Object.fromEntries(formData);const sanitized=this.sanitizeFormData(data);const errors=[];if(!sanitized.name||sanitized.name.length<2){errors.push("Name must be at least 2 characters long")}if(!sanitized.email){errors.push("Email is required")}else if(!this.isValidEmail(sanitized.email)){errors.push("Please enter a valid email address")}if(sanitized.phone&&!this.isValidPhone(sanitized.phone)){errors.push("Please enter a valid phone number")}if(sanitized.message&&sanitized.message.length>1e3){errors.push("Message must be less than 1000 characters")}return{isValid:errors.length===0,errors:errors,data:sanitized}}}class Psychology{constructor(){this.whatsappNumber=CONFIG.contact.whatsappNumber;this.exitIntentShown=false;this.urgencyBarShown=false}init(){this.initializeExitIntent();this.initializeUrgencyBar();this.initializeSocialProof();this.initializeScarcityIndicators()}initializeExitIntent(){const popup=document.getElementById("exitIntentPopup");if(!popup){return}document.addEventListener("mouseleave",e=>{if(e.clientY<=0&&!this.exitIntentShown){this.showExitIntentPopup(popup)}});setTimeout(()=>{if(!this.exitIntentShown){this.showExitIntentPopup(popup)}},3e4);this.setupExitIntentActions(popup)}showExitIntentPopup(popup){popup.classList.add("show");this.exitIntentShown=true;this.startCountdown();if(typeof gtag!=="undefined"){gtag("event","exit_intent_shown",{eventCategory:"engagement",eventLabel:"popup"})}}setupExitIntentActions(popup){const closeBtn=popup.querySelector(".popup-close");const declineBtn=popup.querySelector(".popup-decline");const acceptBtn=popup.querySelector(".popup-accept");closeBtn?.addEventListener("click",()=>this.closeExitIntent(popup));declineBtn?.addEventListener("click",()=>this.closeExitIntent(popup));acceptBtn?.addEventListener("click",()=>{this.handleExitIntentAccept(popup)})}closeExitIntent(popup){popup.classList.remove("show");if(typeof gtag!=="undefined"){gtag("event","exit_intent_closed",{eventCategory:"engagement",eventLabel:"popup"})}}handleExitIntentAccept(popup){const message="Hi! I saw your special offer popup. I would like to claim the FREE consultation and 15% discount for Premium Gift Box services.";const whatsappUrl=`https://wa.me/${this.whatsappNumber}?text=${encodeURIComponent(message)}`;window.open(whatsappUrl,"_blank");popup.classList.remove("show");if(typeof gtag!=="undefined"){gtag("event","exit_intent_converted",{eventCategory:"conversion",eventLabel:"whatsapp_click",value:1})}}startCountdown(){let minutes=14;let seconds=59;const minutesEl=document.getElementById("minutes");const secondsEl=document.getElementById("seconds");const interval=setInterval(()=>{if(seconds===0){if(minutes===0){clearInterval(interval);return}minutes--;seconds=59}else{seconds--}if(minutesEl)minutesEl.textContent=minutes.toString().padStart(2,"0");if(secondsEl)secondsEl.textContent=seconds.toString().padStart(2,"0")},1e3)}initializeUrgencyBar(){const urgencyBar=document.getElementById("urgencyBar");if(!urgencyBar){return}setTimeout(()=>{if(!this.urgencyBarShown){urgencyBar.classList.add("show");this.urgencyBarShown=true}},1e4);this.setupUrgencyBarActions(urgencyBar)}setupUrgencyBarActions(urgencyBar){const closeBtn=urgencyBar.querySelector(".urgency-close");const ctaBtn=urgencyBar.querySelector(".urgency-cta");closeBtn?.addEventListener("click",()=>{urgencyBar.classList.remove("show")});ctaBtn?.addEventListener("click",()=>{const message="Hi! I saw there are only 3 consultation slots left this month. I would like to book one for Premium Gift Box services.";const whatsappUrl=`https://wa.me/${this.whatsappNumber}?text=${encodeURIComponent(message)}`;window.open(whatsappUrl,"_blank");if(typeof gtag!=="undefined"){gtag("event","urgency_bar_clicked",{eventCategory:"conversion",eventLabel:"whatsapp_click"})}})}initializeSocialProof(){const container=document.getElementById("socialProofNotifications");if(!container)return;const notifications=[{text:"Sarah from Jakarta just ordered corporate gift boxes",avatar:"S",type:"order"},{text:"Andi & Maya booked wedding favor consultation",avatar:"A",type:"consultation"},{text:"Budi from Surabaya placed a bulk order",avatar:"B",type:"order"},{text:"Lisa just requested a custom design quote",avatar:"L",type:"quote"},{text:"PT. Maju Bersama renewed their corporate package",avatar:"M",type:"renewal"},{text:"Someone from Solo just viewed our portfolio",avatar:"ðŸ‘¤",type:"view"}];setTimeout(()=>this.showSocialProofNotification(container,notifications),5e3);setInterval(()=>this.showSocialProofNotification(container,notifications),2e4)}showSocialProofNotification(container,notifications){const notification=notifications[Math.floor(Math.random()*notifications.length)];const el=document.createElement("div");el.className="social-notification";el.innerHTML=`\n            <div class="notification-avatar">${notification.avatar}</div>\n            <div class="notification-content">\n                <div class="notification-text">${notification.text}</div>\n                <div class="notification-time">${Math.floor(Math.random()*15)+1} minutes ago</div>\n            </div>\n        `;container.appendChild(el);setTimeout(()=>{el.classList.add("show")},100);setTimeout(()=>{el.classList.remove("show");setTimeout(()=>{if(container.contains(el)){container.removeChild(el)}},300)},4e3)}initializeScarcityIndicators(){this.updateSlotCount();this.showLimitedTimeOffers()}updateSlotCount(){const slotElements=document.querySelectorAll('[data-dynamic="slots"]');const remainingSlots=Math.floor(Math.random()*5)+1;slotElements.forEach(el=>{el.textContent=remainingSlots})}showLimitedTimeOffers(){const offerElements=document.querySelectorAll(".limited-offer");offerElements.forEach(el=>{el.classList.add("active")})}trackConversion(action,label="",value=0){if(typeof gtag!=="undefined"){gtag("event",action,{eventCategory:"conversion",eventLabel:label,value:value})}}trackEngagement(action,label=""){if(typeof gtag!=="undefined"){gtag("event",action,{eventCategory:"engagement",eventLabel:label})}}}document.addEventListener("DOMContentLoaded",()=>{document.documentElement.classList.remove("no-js");document.documentElement.classList.add(CONFIG.device.isMobile?"mobile":CONFIG.device.isTablet?"tablet":"desktop");if(CONFIG.device.isTouchDevice){document.documentElement.classList.add("touch")}if(CONFIG.device.isIOS){document.documentElement.classList.add("ios");const setViewportHeight=()=>{document.documentElement.style.setProperty("--vh",`${window.innerHeight*.01}px`)};setViewportHeight();window.addEventListener("resize",setViewportHeight)}if(CONFIG.device.isAndroid){document.documentElement.classList.add("android")}const slideshow=new Slideshow;const navigation=new Navigation;const psychology=new Psychology;slideshow.init();navigation.init();psychology.init();if(typeof AOS!=="undefined"){AOS.init({duration:CONFIG.animations.defaultDuration,easing:CONFIG.animations.defaultEasing,once:CONFIG.animations.once,offset:CONFIG.animations.offset,disable:CONFIG.device.isMobile&&CONFIG.animations.disableOnLowPerformance})}const loading=document.getElementById("loading");if(loading){setTimeout(()=>{loading.style.opacity="0";setTimeout(()=>{loading.style.display="none"},300)},1e3)}initializeContactForm();initializeWhatsAppButton();initializeFAQ();initializePortfolioFilters();initializeCollectionPreviews();if(CONFIG.features.enableServiceWorker){registerServiceWorker()}});function registerServiceWorker(){if("serviceWorker"in navigator){window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(registration=>{console.log("ServiceWorker registered successfully:",registration.scope)}).catch(error=>{console.error("ServiceWorker registration failed:",error)})})}}function initializeContactForm(){const form=document.getElementById("contactForm");if(!form)return;form.addEventListener("submit",e=>{e.preventDefault();const formData=new FormData(form);const validation=SecurityUtils.validateContactForm(formData);if(!validation.isValid){showFormErrors(validation.errors);return}const message=SecurityUtils.createSafeWhatsAppMessage(validation.data);if(!SecurityUtils.isValidWhatsAppNumber(CONFIG.contact.whatsappNumber)){showFormErrors(["Invalid WhatsApp configuration. Please contact support."]);return}const whatsappUrl=`https://wa.me/${CONFIG.contact.whatsappNumber}?text=${encodeURIComponent(message)}`;window.open(whatsappUrl,"_blank");showFormSuccess("Message prepared! You will be redirected to WhatsApp.");form.reset()})}function showFormErrors(errors){const existingErrors=document.querySelectorAll(".form-error");existingErrors.forEach(error=>error.remove());const errorContainer=document.createElement("div");errorContainer.className="form-error-container";errorContainer.innerHTML=`\n        <div class="form-error">\n            <ul>\n                ${errors.map(error=>`<li>${error}</li>`).join("")}\n            </ul>\n        </div>\n    `;const form=document.getElementById("contactForm");form.insertBefore(errorContainer,form.firstChild);setTimeout(()=>{errorContainer.remove()},5e3)}function showFormSuccess(message){const successContainer=document.createElement("div");successContainer.className="form-success-container";successContainer.innerHTML=`\n        <div class="form-success">\n            ${message}\n        </div>\n    `;const form=document.getElementById("contactForm");form.insertBefore(successContainer,form.firstChild);setTimeout(()=>{successContainer.remove()},3e3)}function initializeWhatsAppButton(){const waButton=document.querySelector(".wa-main-button");if(!waButton)return;waButton.addEventListener("click",()=>{const message="Hi! I would like to know more about your Premium Gift Box services.";const whatsappUrl=`https://wa.me/${CONFIG.contact.whatsappNumber}?text=${encodeURIComponent(message)}`;window.open(whatsappUrl,"_blank")})}function initializeFAQ(){const faqItems=document.querySelectorAll(".faq-item");faqItems.forEach(item=>{const question=item.querySelector(".faq-question");question.addEventListener("click",()=>{const isOpen=item.classList.contains("active");faqItems.forEach(otherItem=>{otherItem.classList.remove("active")});if(!isOpen){item.classList.add("active")}})})}function initializePortfolioFilters(){const filterBtns=document.querySelectorAll(".filter-btn");const portfolioItems=document.querySelectorAll(".portfolio-item");filterBtns.forEach(btn=>{btn.addEventListener("click",()=>{const filter=btn.dataset.filter;filterBtns.forEach(otherBtn=>otherBtn.classList.remove("active"));btn.classList.add("active");portfolioItems.forEach(item=>{if(filter==="all"||item.classList.contains(filter)){item.style.display="block"}else{item.style.display="none"}})})})}function initializeCollectionPreviews(){const previewBtns=document.querySelectorAll(".quick-preview");previewBtns.forEach(btn=>{btn.addEventListener("click",()=>{const collection=btn.dataset.collection;alert(`Preview for ${collection} collection - This would open a detailed gallery`)})})}})();